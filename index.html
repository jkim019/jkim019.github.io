<html>

  <head>
    <meta charset="utf-8">
    <title>JSON Test</title>
    <script src="jquery-3.6.1.min.js"></script>
    <script language="javascript" src="music.json"></script>

  </head>

  <body>
    <div id="serialized">
      User UNFRIENDLY Data: (Serialized)
      <p name="data_print_dirty"></p>

      <!-- <script>
        $(function(){
          var songs = [];

          // upload from json to html
          $.getJSON("music.json", function(data) {

          });
        });
      </script> -->
      <script>
        $.get("music.json",
          function( data ) {
            str = JSON.stringify( data );
            $('p[name="data_print_dirty"]').html(str);
        });



      </script>

    </div>

    <br>

    <div id="user-friendly">
      User FRIENDLY Data:
      <p name="data_print_clean"></p>



      <script>

      $.get("music.json",
        function( data ) {
          var pretty_str = "";
          data.forEach(function(song) {
            pretty_str+= song.title +"<ul>";
            pretty_str+="<li>Artist: " + song.artist;
            pretty_str+="<li>Title: " + song.year;
            // printing out all Genres
            pretty_str+="<li>Genre: ";
            for (var i = 0; i<song.genre.length; i++)
            {


              pretty_str += song.genre[i];

              if (i != song.genre.length)
              {
                //last elem
                if (i > 0) {
                  // multiple elements
                  pretty_str += ", ";
                }

              }
            }
            pretty_str += "</ul>";
          });
          $('p[name="data_print_clean"]').html(pretty_str);
      });

      </script>

    </div>


    <div id="filter">

      <select name="genres">
        <!-- use the script to collect the total amount of genres -->
        <script>
        $.get("music.json", function( data ) {

          // PURPOSE: This function checks a list of genres if an inputted genre
          //          is already in the list.
          // RETURNS: If the inputted genre is in the list of genres (ie we have another
          //          instance of the same genre) return true. else, return false
          function search_genre(genre, all_genres)
          {
            for (var i = 0; i<all_genres.length; i++)
            {
              if (genre == all_genres[i])
              {
                // found the genre in the list of established genres
                return true;
              }

            }
            return false;
          }

          const all_genres = [];

          data.forEach(function(song) {
            // this var keeps track if the newly read genre is already in the list of genres
            for (var i = 0; i<song.genre.length; i++)
            {
              if(search_genre(song.genre[i], all_genres) == false)
              {
                console.log("New Genre Found" + song.genre[i])
                all_genres.push(song.genre[i]);
              }
            }
          });

          // for all genres, list them as an option
          var all_options = "";
          for (var i = 0; i<all_genres.length; i++)
          {
            // write into select tag
            al_options += '<option value="'+all_genres[i]+'">'+all_genres[i]+"</option>";
          }

          $('select[name="genres"]').html(all_options);



        });

        </script>


      </select>



    </div>


  </body>





</html>
